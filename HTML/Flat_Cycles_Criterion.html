<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Flat_Cycles_Criterion</title>
</head>


<body>
<div class="head">
<h1>Theory Flat_Cycles_Criterion</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Flat_Cycles_Criterion.html"><span>Flat_Cycles_Criterion</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><span class="quoted"><span>"</span><a href="Sloped_Graphs.html"><span>../Sloped_Graphs</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>


</span><span class="comment1"><span>(* 1. THE FLAT CYCLE CRITERION *)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_100..107">context</span></span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.Sloped_Graph|locale"><span>Sloped_Graph</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatEdges_def|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatEdges_def|thm"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatEdges_def_raw|axiom"><span class="entity_def" id="offset_128..138">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatEdges.cong|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatEdges.cong|thm"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatEdges|const"><span class="entity_def" id="offset_139..148">FlatEdges</span></span></span></span></span><span class="main"><span>::</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'node</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod|type"><span>×</span></a></span><span> </span><span class="tfree"><span>'node</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span class="tconst"><span>set</span></span></a><span>"</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
</span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>FlatEdges</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Collect|const"><span>{</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.case_prod|const"><span>(</span></a></span><span class="bound"><span>u</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.case_prod|const"><span>,</span></a></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.prod.case_prod|const"><span>)</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Collect|const"><span>.</span></a></span><span> </span><span class="free"><span>edge</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="bound"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>∀</span></a></span><span class="bound"><span>p</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>∈</span></a></span><span> </span><span class="free"><span>PosOf</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>∀</span></a></span><span class="bound"><span>q</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>∈</span></a></span><span> </span><span class="free"><span>PosOf</span></span><span> </span><span class="bound"><span>v</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>v</span></span><span class="main"><span>,</span></span><span class="bound"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span class="main"><span>)</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Collect|const"><span>}</span></a></span><span>"</span></span></span><span>


</span><span class="comment1"><span>(*Any edge in this set is not decreasing*)</span></span><span>
</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatEdges_no_Decr|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatEdges_no_Decr|thm"><span class="entity_def" id="offset_315..332">FlatEdges_no_Decr</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>u</span></span><span class="main"><span>,</span></span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_139..148"><span class="const"><span>FlatEdges</span></span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>u</span></span><span class="main"><span>,</span></span><span class="free"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>v</span></span><span class="main"><span>,</span></span><span class="free"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_128..138"><span>FlatEdges_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.notI|fact"><span>notI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>frule</span></span><span> </span><span>RR_PosOf</span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.safe|method"><span class="operator"><span>safe</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.bspec|fact"><span>bspec</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span>PosOf</span></span></span><span> </span><span class="free"><span class="free"><span>u</span></span></span><span>"</span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span class="main"><span>λ</span></span></span><span class="bound"><span class="bound"><span>p</span></span></span><span class="main"><span class="main"><span>.</span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>∀</span></a></span></a></span><span class="bound"><span class="bound"><span>q</span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>∈</span></a></span></a></span><span class="free"><span class="free"><span>PosOf</span></span></span><span> </span><span class="free"><span class="free"><span>v</span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball|const"><span>.</span></a></span></a></span><span>
          </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span></a></span><span class="free"><span class="free"><span>RR</span></span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="free"><span class="free"><span>u</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="bound"><span class="bound"><span>p</span></span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><span class="main"><span class="main"><span>(</span></span></span><span class="free"><span class="free"><span>v</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="bound"><span class="bound"><span>q</span></span></span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a></span></a><span>"</span></span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>p</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.bspec|fact"><span>bspec</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span class="free"><span>PosOf</span></span></span><span> </span><span class="free"><span class="free"><span>v</span></span></span><span>"</span></span></span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="free"><span class="quoted"><span class="free"><span>q</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>RR_SlopeRels</span><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="free"><span>u</span></span></span><span> </span><span class="quoted"><span class="free"><span>v</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.SlopedRels_def|fact"><span>SlopedRels_def</span></a><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>


</span><span class="comment1"><span>(* A FlatCycle exists if there is a subset which is a cycle and every edge is flat *)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle_def|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle_def|thm"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle_def_raw|axiom"><span class="entity_def" id="offset_735..745">definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle.cong|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle.cong|thm"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle|const"><span class="entity_def" id="offset_746..755">FlatCycle</span></span></span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span class="tconst"><span>bool</span></span></a></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>FlatCycle</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>nds</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span class="bound"><span>i</span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_139..148"><span class="const"><span>FlatEdges</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="const"><span>cycleG</span></span><span> </span><span class="bound"><span>nds</span></span><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle_properties|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle_properties|thm"><span class="entity_def" id="offset_872..892">FlatCycle_properties</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_746..755"><span class="const"><span>FlatCycle</span></span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="const"><span>cycleG</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span class="bound"><span>i</span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span>  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_735..745"><span>FlatCycle_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exE|fact"><span>exE</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> nds </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span>nds</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allI|fact"><span>allI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> i </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allE|fact"><span>allE</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span>i</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impE|fact"><span>impE</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_315..332"><span>FlatEdges_no_Decr</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="skolem"><span>i</span></span><span>"</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="comment1"><span>(*This is in particular the cycle obtained from the definition -(srepeat (butlast xs)), but this property is enough*)</span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_1356..1361">lemma</span></span></span><span> </span><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle_imp_flat_ipath|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycle_imp_flat_ipath|thm"><span class="entity_def" id="offset_1362..1386">FlatCycle_imp_flat_ipath</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_746..755"><span class="const"><span>FlatCycle</span></span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>S</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="const"><span>ipath</span></span><span> </span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Transition_Systems_and_Automata/HOL-Library.Stream.html#Stream.snth|const"><span>!!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Transition_Systems_and_Automata/HOL-Library.Stream.html#Stream.snth|const"><span>!!</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span class="main"><span>)</span></span><span>"</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword3"><span class="command"><span>obtain</span></span></span><span> </span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="offset_1510..1513">cyc</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="const"><span>cycleG</span></span><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span> 
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_1536..1550">no_decr_finite</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span class="bound"><span>i</span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="skolem"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_872..892"><span>FlatCycle_properties</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1356..1361"><span>assms</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>

  </span><span class="comment1"><span>(* Let ys be the non-repeating part of the cycle *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?ys</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.butlast|const"><span class="const"><span>butlast</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?S</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Preliminaries.html#Preliminaries.srepeat|const"><span class="const"><span>srepeat</span></span></a><span> </span><span class="var"><span>?ys</span></span><span>"</span></span></span><span>
  
  </span><span class="comment1"><span>(* Basic properties of cycleG imply xs is not empty and hd xs = last xs *)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1854..1861">xs_nemp</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>[]</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1510..1513"><span>cyc</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_100..107"><span>cycleG_def</span></a><span>  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_1919..1925">xs_len</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater_eq|const"><span>≥</span></a></span><span> </span><span class="numeral"><span>2</span></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1510..1513"><span>cyc</span></a><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_100..107"><span>cycleG_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>path_length_ge2</span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2011..2018">len_pos</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="var"><span>?ys</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.greater|const"><span>&gt;</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1854..1861"><span>xs_nemp</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1510..1513"><span>cyc</span></a><span>  
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="Directed_Graphs.html#Directed_Graphs.Graph.cycleG_def|fact"><span>Graph.cycleG_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.bot_nat_0.not_eq_extremum|fact"><span>bot_nat_0.not_eq_extremum</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_0_conv|fact"><span>length_0_conv</span></a><span> </span><span>pathG_butlast_not_nil</span><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2164..2170">ipaths</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="const"><span>ipath</span></span><span> </span><span class="var"><span>?S</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_100..107"><span>ipath_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allI|fact"><span>allI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjI|fact"><span>conjI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1510..1513"><span>cyc</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_100..107"><span>ipath_def</span></a><span> </span><span>cycle_srepeat_ipath</span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1510..1513"><span>cyc</span></a><span> </span><span>cycle_srepeat_ipath</span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_100..107"><span>ipath_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span> 

  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2363..2377">no_decr_stream</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Transition_Systems_and_Automata/HOL-Library.Stream.html#Stream.snth|const"><span>!!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Transition_Systems_and_Automata/HOL-Library.Stream.html#Stream.snth|const"><span>!!</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>intro</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allI|fact"><span>allI</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>fix</span></span></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="skolem"><span>p</span></span><span> </span><span class="skolem"><span>q</span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?n</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="var"><span>?ys</span></span><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>let</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?k</span></span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="var"><span>?n</span></span><span>"</span></span></span><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2526..2530">wrap</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="skolem"><span>i</span></span><span>  </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.One_nat_def|fact"><span>One_nat_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_pred&apos;|fact"><span>Suc_pred'</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.diff_Suc_eq_diff_pred|fact"><span>diff_Suc_eq_diff_pred</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2011..2018"><span>len_pos</span></a><span>
          </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_butlast|fact"><span>length_butlast</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Rings.html#Euclidean_Rings.mod_Suc|fact"><span>mod_Suc</span></a><span class="main"><span>)</span></span><span>


    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2736..2742">len_le</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>"</span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1919..1925"><span>xs_len</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>

    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_2825..2837">butlast_wrap</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.butlast|const"><span class="const"><span>butlast</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1510..1513"><span>cyc</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1919..1925"><span>xs_len</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.last_conv_nth|fact"><span>last_conv_nth</span></a><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1854..1861"><span>xs_nemp</span></a><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_100..107"><span>cycleG_def</span></a><span> 
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.One_nat_def|fact"><span>One_nat_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_diff_Suc|fact"><span>Suc_diff_Suc</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_le_lessD|fact"><span>Suc_le_lessD</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1510..1513"><span>cyc</span></a><span> </span><span>cycle_iff_nth</span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2011..2018"><span>len_pos</span></a><span>
          </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_butlast|fact"><span>nth_butlast</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Num.html#Num.numeral_2_eq_2|fact"><span>numeral_2_eq_2</span></a><span class="main"><span>)</span></span><span>


    
    </span><span class="comment1"><span>(* The edge in the stream corresponds to an edge in the finite list xs *)</span></span><span>
    </span><span class="comment1"><span>(* Case 1: The index is within the list body (not the wraparound) *)</span></span><span>
    </span><span class="comment1"><span>(* Case 2: The index is the wraparound (last element to first) *)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_3318..3327">cases_mod</span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span>i</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.butlast|const"><span class="const"><span>butlast</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.butlast|const"><span class="const"><span>butlast</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disj|const"><span>∨</span></a></span><span> </span><span class="skolem"><span>i</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.butlast|const"><span class="const"><span>butlast</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.butlast|const"><span class="const"><span>butlast</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc_diff_1|fact"><span>Suc_diff_1</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2011..2018"><span>len_pos</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Rings.html#Euclidean_Rings.mod_less_divisor|fact"><span>mod_less_divisor</span></a><span> </span><a class="entity_ref" href="Preliminaries.html#Preliminaries.nat_cases|fact"><span>nat_cases</span></a><span>
          </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.not_less_eq|fact"><span>not_less_eq</span></a><span class="main"><span>)</span></span><span>


    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?ys</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="var"><span>?k</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?ys</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span><span> </span><span class="var"><span>?n</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span>"</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1536..1550"><span>no_decr_finite</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_3318..3327"><span>cases_mod</span></a><span>
    </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="operator"><span>-</span></span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.disjE|fact"><span>disjE</span></a><span class="main"><span>)</span></span><span>
      </span><span class="comment1"><span>(*edge case, the wrap around*)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allE|fact"><span>allE</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a></span></a><span> </span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span></a></span><span class="main"><span class="main"><span>)</span></span></span><span>"</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impE|fact"><span>impE</span></a><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1919..1925"><span>xs_len</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
        </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allE|fact"><span>allE</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span>p</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allE|fact"><span>allE</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="skolem"><span class="quoted"><span class="skolem"><span>q</span></span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
          </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_butlast|fact"><span>nth_butlast</span></a><span class="main"><span>[</span></span><span class="operator"><span>of</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="skolem"><span>xs</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span class="main"><span>)</span></span><span>"</span></span></span><span> </span><span class="quoted"><span class="skolem"><span>xs</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2736..2742"><span>len_le</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2825..2837"><span>butlast_wrap</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2526..2530"><span>wrap</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
      </span><span class="comment1"><span>(*trivial case*)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allE|fact"><span>allE</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span class="skolem"><span>i</span></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Rings.html#Rings.modulo_class.modulo|const"><span>mod</span></a></span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.butlast|const"><span class="const"><a class="entity_ref" href="../../HOL/HOL/List.html#List.butlast|const"><span class="const"><span>butlast</span></span></a></span></a><span> </span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span class="main"><span class="main"><span>)</span></span></span><span>"</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
        </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.One_nat_def|fact"><span>One_nat_def</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2736..2742"><span>len_le</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2011..2018"><span>len_pos</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length_butlast|fact"><span>length_butlast</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Rings.html#Euclidean_Rings.mod_Suc|fact"><span>mod_Suc</span></a><span>
            </span><a class="entity_ref" href="../../HOL/HOL/Euclidean_Rings.html#Euclidean_Rings.mod_less_divisor|fact"><span>mod_less_divisor</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.not_less_eq|fact"><span>not_less_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth_butlast|fact"><span>nth_butlast</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>
      
    </span><span class="keyword3"><span class="command"><span>thus</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Transition_Systems_and_Automata/HOL-Library.Stream.html#Stream.snth|const"><span>!!</span></a></span><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="var"><span>?S</span></span><span> </span><span class="main"><a class="entity_ref" href="../../AFP/Transition_Systems_and_Automata/HOL-Library.Stream.html#Stream.snth|const"><span>!!</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="skolem"><span>i</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span>"</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2011..2018"><span>len_pos</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span> 
    </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2164..2170"><span>ipaths</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_2363..2377"><span>no_decr_stream</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycleE|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.FlatCycleE|thm"><span class="entity_def" id="offset_4338..4348">FlatCycleE</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_746..755"><span class="const"><span>FlatCycle</span></span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>xs</span></span><span class="main"><span>.</span></span><span> </span><span class="const"><span>ipath</span></span><span> </span><span class="bound"><span>xs</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>i</span></span><span> </span><span class="bound"><span>p</span></span><span> </span><span class="bound"><span>q</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><span class="free"><span>RR</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../AFP/Transition_Systems_and_Automata/HOL-Library.Stream.html#Stream.snth|const"><span>!!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span class="bound"><span>p</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>xs</span></span><span class="main"><a class="entity_ref" href="../../AFP/Transition_Systems_and_Automata/HOL-Library.Stream.html#Stream.snth|const"><span>!!</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>i</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span class="bound"><span>q</span></span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Sloped_Graphs.html#Sloped_Graphs.slope.Decr|const"><span class="const"><span>Decr</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>P</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>drule</span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_1362..1386"><span>FlatCycle_imp_flat_ipath</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><span>cycle_srepeat_ipath</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.notFlatCycleI|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.notFlatCycleI|thm"><span>notFlatCycleI</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"
   </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>nds</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_139..148"><span class="const"><span>FlatEdges</span></span></a><span> </span><span class="main"><span>⟹</span></span><span>
           </span><span class="const"><span>cycleG</span></span><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span class="const"><span>HOL.False</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_746..755"><span class="const"><span>FlatCycle</span></span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_735..745"><span>FlatCycle_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.notI|fact"><span>notI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exE|fact"><span>exE</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.notFlatCycleI&apos;|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.notFlatCycleI&apos;|thm"><span>notFlatCycleI'</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"
   </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>nds</span></span><span class="main"><span>.</span></span><span> </span><span class="const"><span>pathG</span></span><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><span>⟹</span></span><span> 
           </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span class="bound"><span>i</span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>&lt;</span></a></span><a class="entity_ref" href="../../HOL/HOL/List.html#List.length|const"><span class="const"><span>length</span></span></a><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.minus_class.minus|const"><span>-</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><span class="main"><span>(</span></span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><span class="bound"><span>i</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.nth|const"><span>!</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.Suc|const"><span class="const"><span>Suc</span></span></a><span> </span><span class="bound"><span>i</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_139..148"><span class="const"><span>FlatEdges</span></span></a><span> </span><span class="main"><span>⟹</span></span><span>
           </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.hd|const"><span class="const"><span>hd</span></span></a><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.last|const"><span class="const"><span>last</span></span></a><span> </span><span class="bound"><span>nds</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.False|const"><span class="const"><span>HOL.False</span></span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_746..755"><span class="const"><span>FlatCycle</span></span></a><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span class="main"><span>(</span></span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_735..745"><span>FlatCycle_def</span></a><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_100..107"><span>cycleG_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.notI|fact"><span>notI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>elim</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exE|fact"><span>exE</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conjE|fact"><span>conjE</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>assumption</span></span><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>theorem</span></span></span><span> </span><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.Flat_Cycles_Criterion|fact"><span class="entity_def" id="Flat_Cycles_Criterion.Sloped_Graph.Flat_Cycles_Criterion|thm"><span>Flat_Cycles_Criterion</span></span></span><span class="main"><span>:</span></span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_746..755"><span class="const"><span>FlatCycle</span></span></a><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span class="const"><span>InfiniteDescent</span></span><span>"</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.notI|fact"><span>notI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_4338..4348"><span>FlatCycleE</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Flat_Cycles_Criterion.html#offset_100..107"><span>InfiniteDescent_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> xs </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span class="main"><span>(</span></span><span class="operator"><span>erule</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.allE|fact"><span>allE</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>of</span></span><span> </span><span class="main"><span class="main"><span>_</span></span></span><span> </span><span class="quoted"><span class="quoted"><span class="quoted"><span>"</span><span class="skolem"><span class="skolem"><span>xs</span></span></span><span>"</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><span>descentIpath_iff_snth</span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span> </span><span class="comment1"><span>(* context Heighted_Graph *)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span> 
</span></pre>
</body>

</html>